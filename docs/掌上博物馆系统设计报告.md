# 掌上博物馆系统设计报告

## 1. 项目概述

### 1.1 项目背景与目标

掌上博物馆是一款基于HarmonyOS平台开发的移动应用，旨在为用户提供便捷的博物馆文物浏览、搜索和互动体验。该项目通过数字技术将博物馆文物资源进行数字化呈现，让用户无需亲临现场即可欣赏珍贵文物，同时提供丰富的交互功能和个性化服务。

主要目标包括：

- 提供文物高清图像和3D模型浏览功能
- 实现文物信息的智能搜索与图像识别搜索
- 支持用户评论、收藏等社交互动功能
- 提供个性化推荐和用户管理
- 确保系统在多用户并发访问下的稳定性能

### 1.2 适用范围

本设计报告适用于掌上博物馆项目的开发团队、测试团队和维护人员，包括前端开发人员、后端开发人员、UI设计师、测试工程师等。

## 2. 系统架构设计

### 2.1 总体架构

掌上博物馆采用前后端分离的架构，前端使用HarmonyOS原生应用开发框架，后端采用微服务架构。系统整体架构如下图所示：

```
+--------------------------------+
|          客户端层              |
|  +-------------------------+   |
|  |     HarmonyOS 应用     |   |
|  +-------------------------+   |
+--------------------------------+
              |
              | HTTP/HTTPS
              ↓
+--------------------------------+
|          API网关层            |
|  +-------------------------+   |
|  |    API Gateway          |   |
|  +-------------------------+   |
+--------------------------------+
              |
              ↓
+--------------------------------+
|          业务服务层            |
| +-------+ +-------+ +--------+ |
| |文物服务| |用户服务| |搜索服务| |
| +-------+ +-------+ +--------+ |
| +-------+ +-------+ +--------+ |
| |评论服务| |收藏服务| |推荐服务| |
| +-------+ +-------+ +--------+ |
+--------------------------------+
              |
              ↓
+--------------------------------+
|          数据存储层            |
| +-------+ +--------+ +------+  |
| | MySQL | |MongoDB | |Redis |  |
| +-------+ +--------+ +------+  |
+--------------------------------+
```

### 2.2 技术架构

#### 2.2.1 前端架构

前端采用HarmonyOS开发框架，主要技术栈包括：

- 开发语言：ArkTS
- UI框架：HarmonyOS原生UI组件
- 架构模式：MVVM (Model-View-ViewModel)
- 状态管理：AppStorage
- 网络请求：HTTP请求模块
- 图像处理：HMS图像分析服务

#### 2.2.2 后端架构

后端采用微服务架构，主要技术栈包括：

- 开发语言：Node.js
- Web框架：Express
- 数据库：MySQL (关系型数据) + MongoDB (非关系型数据)
- 缓存：Redis
- 搜索引擎：Elasticsearch
- 图像识别：TensorFlow模型
- API文档：Swagger

## 3. 功能模块设计

### 3.1 功能模块划分

根据业务需求，掌上博物馆系统划分为以下功能模块：

1. **首页模块**：展示推荐文物、热门展览等内容
2. **文物浏览模块**：按照分类、朝代、材质等维度浏览文物
3. **文物详情模块**：展示文物详细信息、高清图像和3D模型
4. **搜索模块**：支持文本搜索和语义搜索
5. **图像搜索模块**：通过上传图片识别相似文物
6. **用户管理模块**：用户注册、登录、个人信息管理
7. **评论模块**：文物评论和点赞
8. **收藏模块**：用户收藏文物管理
9. **个人中心模块**：用户个性化内容和历史记录

### 3.2 核心功能流程

#### 3.2.1 文物浏览流程

```
用户 -> 选择分类 -> 浏览文物列表 -> 查看文物详情
                 -> 筛选条件 -> 浏览筛选结果 -> 查看文物详情
```

#### 3.2.2 图像搜索流程

```
用户 -> 上传图片 -> 系统处理图像 -> 特征提取 -> 相似度匹配 -> 返回相似文物列表 -> 用户查看结果
```

## 4. 数据库设计

### 4.1 关系模型设计

#### 文物表(artifacts)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| id | INT | 主键，自增 |
| name | VARCHAR(100) | 文物名称 |
| dynasty | VARCHAR(50) | 朝代 |
| category | VARCHAR(50) | 分类 |
| material | VARCHAR(50) | 材质 |
| description | TEXT | 文物描述 |
| era | VARCHAR(100) | 年代 |
| unearthed_site | VARCHAR(200) | 出土地点 |
| museum | VARCHAR(100) | 所属博物馆 |
| collection_no | VARCHAR(50) | 馆藏编号 |
| create_time | TIMESTAMP | 创建时间 |
| update_time | TIMESTAMP | 更新时间 |

#### 文物图像表(artifact_images)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| id | INT | 主键，自增 |
| artifact_id | INT | 外键，关联文物表 |
| image_url | VARCHAR(255) | 图像URL |
| image_type | TINYINT | 图像类型(1:封面,2:高清图,3:细节图) |
| sequence | INT | 图像顺序 |
| create_time | TIMESTAMP | 创建时间 |

#### 用户表(users)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| id | INT | 主键，自增 |
| username | VARCHAR(50) | 用户名 |
| password | VARCHAR(100) | 密码(加密存储) |
| nickname | VARCHAR(50) | 昵称 |
| avatar_url | VARCHAR(255) | 头像URL |
| phone | VARCHAR(20) | 手机号 |
| email | VARCHAR(100) | 邮箱 |
| status | TINYINT | 状态(0:禁用,1:正常) |
| register_time | TIMESTAMP | 注册时间 |
| last_login_time | TIMESTAMP | 最后登录时间 |

#### 评论表(comments)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| id | INT | 主键，自增 |
| artifact_id | INT | 外键，关联文物表 |
| user_id | INT | 外键，关联用户表 |
| content | TEXT | 评论内容 |
| like_count | INT | 点赞数 |
| create_time | TIMESTAMP | 创建时间 |
| update_time | TIMESTAMP | 更新时间 |

#### 收藏表(collections)

| 字段名 | 类型 | 说明 |
|-------|------|------|
| id | INT | 主键，自增 |
| user_id | INT | 外键，关联用户表 |
| artifact_id | INT | 外键，关联文物表 |
| create_time | TIMESTAMP | 收藏时间 |

### 4.2 文档模型设计(MongoDB)

#### 文物详情(artifact_details)

```json
{
  "_id": "ObjectId",
  "artifact_id": 123,
  "name": "青花瓷瓶",
  "detailed_info": "详细的文物背景和历史信息...",
  "specifications": {
    "height": 30.5,
    "width": 15.2,
    "weight": 1.5,
    "volume": 2.0
  },
  "cultural_significance": "文化价值和历史意义...",
  "preservation_status": "保存状态描述...",
  "research_findings": "相关研究发现...",
  "3d_model_url": "https://example.com/models/123.glb",
  "related_artifacts": [124, 125, 126],
  "tags": ["瓷器", "明代", "宫廷用品"],
  "metadata": {
    "created_at": "ISODate",
    "updated_at": "ISODate"
  }
}
```

## 5. 接口设计

### 5.1 API接口规范

掌上博物馆系统API遵循RESTful设计风格，主要接口规范如下：

- 使用HTTP动词表示操作：GET(查询)、POST(新建)、PUT(更新)、DELETE(删除)
- 接口路径遵循资源层次结构：/api/v1/{resource}/{id}
- 统一返回格式：

  ```json
  {
    "code": 200,      // 状态码
    "message": "操作成功", // 状态信息
    "data": {}        // 返回数据
  }
  ```

- 状态码说明：
  - 200: 成功
  - 400: 请求参数错误
  - 401: 未授权
  - 403: 权限不足
  - 404: 资源不存在
  - 500: 服务器内部错误

### 5.2 核心接口定义

#### 文物相关接口

| 接口名称 | 请求方式 | 接口路径 | 说明 |
|---------|---------|---------|------|
| 获取文物列表 | GET | /api/v1/artifacts | 分页获取文物列表 |
| 获取文物详情 | GET | /api/v1/artifacts/{id} | 获取指定文物详情 |
| 按条件筛选文物 | GET | /api/v1/artifacts/filter | 按条件筛选文物 |
| 获取文物评论 | GET | /api/v1/artifacts/{id}/comments | 获取文物评论 |
| 图像搜索文物 | POST | /api/v1/artifacts/image-search | 以图搜图 |

#### 用户相关接口

| 接口名称 | 请求方式 | 接口路径 | 说明 |
|---------|---------|---------|------|
| 用户注册 | POST | /api/v1/users/register | 用户注册 |
| 用户登录 | POST | /api/v1/users/login | 用户登录 |
| 获取用户信息 | GET | /api/v1/users/{id} | 获取用户信息 |
| 更新用户信息 | PUT | /api/v1/users/{id} | 更新用户信息 |
| 获取用户收藏 | GET | /api/v1/users/{id}/collections | 获取用户收藏列表 |

## 6. UI设计

### 6.1 整体风格

掌上博物馆应用整体采用清新、典雅的设计风格，以米色、青色作为主色调，突出文物的历史感和艺术性。界面设计遵循HarmonyOS设计规范，强调简洁性和一致性。

### 6.2 主要界面设计

1. **首页**：
   - 顶部搜索栏
   - 轮播图展示精选文物
   - 分类导航
   - 推荐文物瀑布流

2. **文物详情页**：
   - 高清图片轮播
   - 3D模型交互区域
   - 文物基本信息卡片
   - 详细描述区域
   - 相关文物推荐
   - 评论区域

3. **图像搜索页**：
   - 图片上传区域
   - 相机拍摄入口
   - 搜索结果列表

4. **个人中心**：
   - 用户信息概览
   - 收藏列表
   - 浏览历史
   - 系统设置

## 7. 安全设计

### 7.1 身份认证与授权

- 采用JWT(JSON Web Token)进行用户认证
- 实现基于角色的访问控制(RBAC)
- 敏感API接口加入权限验证
- 密码加密存储(使用bcrypt算法)

### 7.2 数据安全

- 所有通信采用HTTPS加密传输
- 敏感信息(如用户密码)单向加密存储
- 定期数据备份机制
- 数据访问审计日志

### 7.3 应用安全

- 防SQL注入措施：使用参数化查询
- 防XSS攻击：输入输出过滤
- 防CSRF攻击：使用CSRF Token
- 限流/防DDoS机制：API网关层实现请求限制

## 8. 性能设计

### 8.1 性能目标

- 首页加载时间：<2秒
- 文物详情页加载：<3秒
- 图像搜索响应时间：<5秒
- 系统支持并发用户数：>100
- API接口响应时间：<1秒

### 8.2 性能优化策略

- CDN加速静态资源(图片、3D模型等)
- Redis缓存热门文物数据
- 数据库索引优化
- 延迟加载(懒加载)大图片和3D模型
- API响应数据压缩
- 前端资源压缩与合并

## 9. 部署方案

### 9.1 环境配置

- **开发环境**：
  - 前端：DevEco Studio 3.1.0
  - 后端：Node.js v16.x
  - 数据库：MySQL 8.0, MongoDB 5.0
  
- **测试环境**：
  - 服务器：腾讯云 2核4G
  - 操作系统：CentOS 8
  - 容器化：Docker, Docker Compose
  
- **生产环境**：
  - 服务器集群：阿里云ECS
  - 负载均衡：阿里云SLB
  - 对象存储：阿里云OSS

### 9.2 部署架构

```
                  [负载均衡]
                      |
        +--------------------------+
        |            |             |
  [应用服务器1]  [应用服务器2]  [应用服务器n]
        |            |             |
  +----------------------------------+
  |                                 |
  |        [数据库集群]               |
  |                                 |
  +----------------------------------+
        |            |             |
  [对象存储]  [缓存服务器]  [搜索服务器]
```

## 10. 项目规划

### 10.1 开发周期

总计划周期：3个月

| 阶段 | 时间 | 主要任务 |
|-----|------|---------|
| 需求分析 | 2周 | 用户需求调研、功能需求分析、系统需求规格说明书编写 |
| 概要设计 | 2周 | 系统架构设计、数据库设计、接口设计、原型设计 |
| 详细设计 | 2周 | UI设计、详细技术方案制定 |
| 开发实现 | 6周 | 前端开发、后端开发、数据库实现、接口联调 |
| 测试 | 2周 | 单元测试、集成测试、系统测试、性能测试 |
| 部署上线 | 1周 | 环境部署、试运行、正式上线 |

### 10.2 里程碑计划

1. **M1**：需求分析完成，确定功能范围（T+2周）
2. **M2**：系统原型设计完成（T+4周）
3. **M3**：核心功能开发完成（T+8周）
4. **M4**：系统测试完成（T+10周）
5. **M5**：系统正式上线（T+12周）

## 11. 风险评估与对策

### 11.1 主要风险

| 风险 | 概率 | 影响 | 应对策略 |
|-----|-----|------|---------|
| 需求变更频繁 | 中 | 高 | 采用敏捷开发方法，增量式迭代开发 |
| 文物图像数据量大 | 高 | 中 | 采用分布式存储和CDN加速策略 |
| 图像识别精度不足 | 中 | 高 | 引入多种识别算法，持续优化模型 |
| 系统性能瓶颈 | 中 | 高 | 前期进行架构评审，定期性能测试 |
| 用户体验不佳 | 低 | 高 | 进行用户测试，收集反馈持续改进 |

### 11.2 应对措施

- 建立畅通的沟通渠道，及时响应需求变更
- 制定详细的测试计划，覆盖功能和性能测试
- 采用可扩展的架构设计，预留系统扩展空间
- 定期进行代码审查和重构，保证代码质量
- 制定应急预案，确保系统出现问题时能快速响应

## 12. 附录

### 12.1 术语表

| 术语 | 描述 |
|-----|------|
| ArkTS | 华为鸿蒙系统的应用开发语言 |
| HMS | Harmony Mobile Services，华为移动服务 |
| MVVM | Model-View-ViewModel，一种软件架构模式 |
| RESTful | 一种软件架构风格，用于设计网络应用程序API |
| JWT | JSON Web Token，一种开放标准，用于在各方之间安全地传输信息 |

### 12.2 参考文献

1. 《HarmonyOS应用开发指南》，华为开发者联盟，2023
2. 《RESTful Web Services》，Leonard Richardson，Sam Ruby著，2007
3. 《MongoDB: The Definitive Guide》，Kristina Chodorow著，2019
4. 《Mobile Design Pattern Gallery》，Theresa Neil著，2014
